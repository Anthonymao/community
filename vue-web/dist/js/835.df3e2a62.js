(self["webpackChunkvue_web"]=self["webpackChunkvue_web"]||[]).push([[835],{6154:function(t,e,o){var n,a,r;(function(o,s){a=[],n=s,r="function"===typeof n?n.apply(e,a):n,void 0===r||(t.exports=r)})(0,(function(){"use strict";function e(t,e){return"undefined"==typeof e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}function n(t,e,o){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){l(n.response,e,o)},n.onerror=function(){console.error("could not download file")},n.send()}function a(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&299>=e.status}function r(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(n){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var s="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof o.g&&o.g.global===o.g?o.g:void 0,i=s.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=s.saveAs||("object"!=typeof window||window!==s?function(){}:"download"in HTMLAnchorElement.prototype&&!i?function(t,e,o){var i=s.URL||s.webkitURL,l=document.createElement("a");e=e||t.name||"download",l.download=e,l.rel="noopener","string"==typeof t?(l.href=t,l.origin===location.origin?r(l):a(l.href)?n(t,e,o):r(l,l.target="_blank")):(l.href=i.createObjectURL(t),setTimeout((function(){i.revokeObjectURL(l.href)}),4e4),setTimeout((function(){r(l)}),0))}:"msSaveOrOpenBlob"in navigator?function(t,o,s){if(o=o||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(e(t,s),o);else if(a(t))n(t,o,s);else{var i=document.createElement("a");i.href=t,i.target="_blank",setTimeout((function(){r(i)}))}}:function(t,e,o,a){if(a=a||open("","_blank"),a&&(a.document.title=a.document.body.innerText="downloading..."),"string"==typeof t)return n(t,e,o);var r="application/octet-stream"===t.type,l=/constructor/i.test(s.HTMLElement)||s.safari,u=/CriOS\/[\d]+/.test(navigator.userAgent);if((u||r&&l||i)&&"undefined"!=typeof FileReader){var d=new FileReader;d.onloadend=function(){var t=d.result;t=u?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=t:location=t,a=null},d.readAsDataURL(t)}else{var c=s.URL||s.webkitURL,p=c.createObjectURL(t);a?a.location=p:location.href=p,a=null,setTimeout((function(){c.revokeObjectURL(p)}),4e4)}});s.saveAs=l.saveAs=l,t.exports=l}))},4835:function(t,e,o){"use strict";o.r(e),o.d(e,{default:function(){return E}});var n=o(3396),a=o(7139),r=o(9242);const s={class:"content"};function i(t,e,o,i,l,u){const d=(0,n.up)("a-popover"),c=(0,n.up)("a-step"),p=(0,n.up)("a-steps"),f=(0,n.up)("StepTwo"),m=(0,n.up)("StepThree"),w=(0,n.up)("a-card");return(0,n.wg)(),(0,n.j4)(w,{bordered:!1},{default:(0,n.w5)((()=>[(0,n.Wm)(p,{class:"steps",current:l.currentTab},{progressDot:(0,n.w5)((({index:t,status:e,prefixCls:o})=>[(0,n.Wm)(d,null,{content:(0,n.w5)((()=>[(0,n._)("span",null,"step "+(0,a.zw)(t)+" status: "+(0,a.zw)(e),1)])),default:(0,n.w5)((()=>[(0,n._)("span",{class:(0,a.C_)(`${o}-icon-dot`)},null,2)])),_:2},1024)])),default:(0,n.w5)((()=>[(0,n.Wm)(c,{title:"投票项目ID"}),(0,n.Wm)(c,{title:"加密套件"}),(0,n.Wm)(c,{title:"完成"})])),_:1},8,["current"]),(0,n._)("div",s,[(0,n.wy)((0,n.Wm)(f,{onNextStep:u.nextStep,onPrevStep:u.prevStep},null,8,["onNextStep","onPrevStep"]),[[r.F8,1===l.currentTab]]),(0,n.wy)((0,n.Wm)(m,{onFinish:u.finish},null,8,["onFinish"]),[[r.F8,2===l.currentTab]])])])),_:1})}const l=t=>((0,n.dD)("data-v-77d52f40"),t=t(),(0,n.Cn)(),t),u={style:{margin:"3px auto 0"}},d=l((()=>(0,n._)("h5",{style:{"text-align":"center","margin-top":"20px"}},"本地生成匿名灵活投票加密套件",-1))),c=(0,n.Uk)(" 本地下载加密信息文件 "),p=(0,n.Uk)("上一步"),f=(0,n.Uk)("上传公钥"),m=l((()=>(0,n._)("div",{class:"step-form-style-desc"},[(0,n._)("h3",null,"说明"),(0,n._)("h4",null,"加入匿名灵活投票事项：请根据以上项目ID返回投票信息完成投票表决。")],-1)));function w(t,e,o,r,s,i){const l=(0,n.up)("a-descriptions-item"),w=(0,n.up)("a-descriptions"),b=(0,n.up)("a-form-item"),h=(0,n.up)("PlusOutlined"),v=(0,n.up)("a-button"),g=(0,n.up)("a-divider"),S=(0,n.up)("a-form");return(0,n.wg)(),(0,n.iD)("div",u,[(0,n.Wm)(S,{model:t.formState,name:"custom-validation",rules:t.rules,labelCol:{lg:{span:7},sm:{span:7}},wrapperCol:{lg:{span:10},sm:{span:12}},style:{margin:"40px auto 0"},autocomplete:"off"},{default:(0,n.w5)((()=>[d,(0,n.Wm)(b,{label:"加密参数",rules:[{required:!0}]},{default:(0,n.w5)((()=>[(0,n.Wm)(w,{bordered:"true",column:{xxl:1,xl:1,lg:1,md:1,sm:1,xs:1}},{default:(0,n.w5)((()=>[(0,n.Wm)(l,{label:"投票地址"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,a.zw)(t.formState.addr),1)])),_:1}),(0,n.Wm)(l,{label:"P"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,a.zw)(t.formState.P),1)])),_:1}),(0,n.Wm)(l,{label:"Q"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,a.zw)(t.formState.Q),1)])),_:1}),(0,n.Wm)(l,{label:"G"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,a.zw)(t.formState.G),1)])),_:1}),(0,n.Wm)(l,{label:"投票人数n"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,a.zw)(t.formState.n),1)])),_:1}),(0,n.Wm)(l,{label:"门限人数k"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,a.zw)(t.formState.k),1)])),_:1})])),_:1})])),_:1}),(0,n.Wm)(b,{"has-feedback":"",label:"获取加密参数",name:"signature"},{default:(0,n.w5)((()=>[(0,n.Wm)(v,{size:"large",type:"dashed",style:{width:"80%"},onClick:t.generatepub,disabled:""!=t.formState.epub},{default:(0,n.w5)((()=>[(0,n.Wm)(h),c])),_:1},8,["onClick","disabled"])])),_:1}),(0,n.Wm)(b,{wrapperCol:{span:24},style:{"text-align":"center"}},{default:(0,n.w5)((()=>[(0,n.Wm)(v,{type:"primary",onClick:t.prevStep},{default:(0,n.w5)((()=>[p])),_:1},8,["onClick"]),(0,n.Wm)(v,{type:"primary","html-type":"submit",style:{"margin-left":"20px"},onClick:t.nextStep},{default:(0,n.w5)((()=>[f])),_:1},8,["onClick"])])),_:1}),(0,n.Wm)(g),m])),_:1},8,["model","rules"])])}o(333);var b=o(4870),h=o(252),v=o(6154),g=(0,n.aZ)({inject:["reload"],setup(){const t=(0,b.qj)({addr:"",P:"",Q:"",G:"",n:"",k:"",rpub:"",epub:""});let e=async(t,e)=>""===e?Promise.reject("请根据要求操作"):Promise.resolve();const o={signature:[{required:!0,validator:e,trigger:"change"}]};return{rules:o,validateSignature:e,formState:t}},created(){console.log("chancan",this.$route.params.info),this.weinfo(this.$route.params.info)},methods:{weinfo(t){t=JSON.parse(t),console.log("ddddsdsd",t.addr),this.formState.addr=t.addr,this.formState.P=t.encryption[0],this.formState.Q=t.encryption[1],this.formState.G=t.encryption[2],this.formState.n=t.encryption[3],this.formState.k=t.encryption[4]},prevStep(){this.$router.push("/addvoting")},generatepub(){var t=new Object;t.P=this.formState.P,t.Q=this.formState.Q,t.G=this.formState.G;var e=generatekey1(t);this.formState.rpub=e.ring_pk,this.formState.epub=e.elgamal_pk,console.log("sdsdsdsdsd",this.formState.rpub,this.formState.epub);var o=new Object;o.addr=this.formState.addr;var n=Object.assign({},o,t,e);this.downloadTxt(n)},downloadTxt(t){let e=JSON.stringify(t),o=new Blob([e],{type:"text/plain;charset=utf-8"});(0,v.saveAs)(o,"匿名灵活投票密钥信息.txt"),h.ZP.destroy(),h.ZP.success("请注意保存匿名灵活投票密钥文件")},nextStep(){console.log("this.formState.rpub",this.formState.epub,typeof this.formState.epub),console.log("this.formState.rpub",this.formState.rpub,typeof this.formState.rpub),this.$http.post("http://192.168.5.42:8888/voteravc/avc_upload_pk",{name:sessionStorage.getItem("user"),password:sessionStorage.getItem("pass"),uid:sessionStorage.getItem("uid"),voteaddr:this.formState.addr,rpub:this.formState.rpub,epub:this.formState.epub}).then((t=>{console.log(t),"success"===t.data.result&&this.$emit("nextStep"),"error1"==t.data.result&&(h.ZP.destroy(),h.ZP.warning("请检查登录")),"error2"==t.data.result&&(h.ZP.destroy(),h.ZP.warning("上链失败"),this.reload())})).catch((function(t){console.log(t)}))}}}),S=o(89);const y=(0,S.Z)(g,[["render",w],["__scopeId","data-v-77d52f40"]]);var k=y;const _={style:{margin:"40px auto 0"}},x=(0,n.Uk)(" 请等待其他投票参与方共同建立系统公钥 "),W=(0,n.Uk)("开始投票");function T(t,e,o,a,r,s){const i=(0,n.up)("a-button"),l=(0,n.up)("a-result");return(0,n.wg)(),(0,n.iD)("div",_,[(0,n.Wm)(l,{status:"success",title:"您已经成功加入该投票活动",model:t.formState},{subTitle:(0,n.w5)((()=>[x])),extra:(0,n.w5)((()=>[(0,n.Wm)(i,{key:"buy",onClick:t.voting},{default:(0,n.w5)((()=>[W])),_:1},8,["onClick"])])),_:1},8,["model"])])}var U=(0,n.aZ)({inject:["reload"],methods:{voting(){this.$router.push("/voting")}}});const j=(0,S.Z)(U,[["render",T]]);var C=j,P={name:"StepForm",components:{StepTwo:k,StepThree:C},data(){return{currentTab:1,form:null,title:""}},methods:{nextStep(){this.currentTab<3&&(this.currentTab+=1)},prevStep(){this.currentTab>0&&(this.currentTab-=1)},finish(){this.currentTab=0}}};const O=(0,S.Z)(P,[["render",i],["__scopeId","data-v-7fbc2ab1"]]);var E=O}}]);
//# sourceMappingURL=835.df3e2a62.js.map