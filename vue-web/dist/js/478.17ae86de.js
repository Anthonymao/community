"use strict";(self["webpackChunkvue_web"]=self["webpackChunkvue_web"]||[]).push([[478],{5478:function(e,t,a){a.r(t),a.d(t,{default:function(){return C}});var r=a(3396),s=a(7139);const l=e=>((0,r.dD)("data-v-785b9238"),e=e(),(0,r.Cn)(),e),o={style:{margin:"3px auto 0"}},d=l((()=>(0,r._)("h5",{style:{"text-align":"center",margin:"20px"}},"权重投票活动链上选票信息汇总",-1))),i=(0,r.Uk)("选票信息"),n=(0,r.Uk)("上一步"),m=(0,r.Uk)("获取结果"),u=l((()=>(0,r._)("div",{class:"step-form-style-desc"},[(0,r._)("h3",null,"说明"),(0,r._)("h4",null,"加入匿名权重投票事项：请根据以上项目ID返回投票信息完成投票表决。")],-1)));function p(e,t,a,l,p,c){const f=(0,r.up)("a-descriptions-item"),w=(0,r.up)("a-descriptions"),g=(0,r.up)("a-tooltip"),S=(0,r.up)("a-table"),W=(0,r.up)("a-form-item"),C=(0,r.up)("a-spin"),h=(0,r.up)("a-button"),k=(0,r.up)("a-divider"),y=(0,r.up)("a-form"),b=(0,r.up)("a-card");return(0,r.wg)(),(0,r.j4)(b,{bordered:!1},{default:(0,r.w5)((()=>[(0,r._)("div",o,[(0,r.Wm)(y,{model:e.formStateWe,name:"custom-validation",rules:e.rules,labelCol:{lg:{span:7},sm:{span:7}},wrapperCol:{lg:{span:10},sm:{span:12}},style:{margin:"40px auto 0"},autocomplete:"off"},{default:(0,r.w5)((()=>[d,(0,r.Wm)(W,{label:"投票信息",rules:[{required:!0}]},{default:(0,r.w5)((()=>[(0,r.Wm)(w,{bordered:"true",column:{xxl:1,xl:1,lg:1,md:1,sm:1,xs:1}},{default:(0,r.w5)((()=>[(0,r.Wm)(f,{label:"投票地址"},{default:(0,r.w5)((()=>[(0,r.Uk)((0,s.zw)(e.formStateWe.addr),1)])),_:1})])),_:1}),""!=e.formStateWe.data?((0,r.wg)(),(0,r.j4)(S,{key:0,columns:e.columns,"data-source":e.formStateWe.data,pagination:e.mypagination,size:"large",bordered:""},{bodyCell:(0,r.w5)((({column:e,text:t})=>["name"===e.dataIndex?((0,r.wg)(),(0,r.j4)(g,{key:0},{title:(0,r.w5)((()=>[(0,r.Uk)((0,s.zw)(t),1)])),default:(0,r.w5)((()=>[(0,r.Uk)(" "+(0,s.zw)(t),1)])),_:2},1024)):(0,r.kq)("",!0)])),title:(0,r.w5)((()=>[i])),_:1},8,["columns","data-source","pagination"])):(0,r.kq)("",!0)])),_:1}),(0,r.Wm)(W,{label:"统计结果",rules:[{required:!0}]},{default:(0,r.w5)((()=>[e.formStateWe.sum?((0,r.wg)(),(0,r.j4)(w,{key:0,bordered:"true",column:{xxl:1,xl:1,lg:1,md:1,sm:1,xs:1}},{default:(0,r.w5)((()=>[(0,r.Wm)(f,{label:"决议得票"},{default:(0,r.w5)((()=>[(0,r.Uk)((0,s.zw)(e.formStateWe.sum),1)])),_:1})])),_:1})):(0,r.kq)("",!0),""===e.formStateWe.res&&""!==e.formStateWe.click?((0,r.wg)(),(0,r.j4)(C,{key:1,size:"small"})):(0,r.kq)("",!0)])),_:1}),(0,r.Wm)(W,{label:"表决结果",rules:[{required:!0}]},{default:(0,r.w5)((()=>[e.formStateWe.res?((0,r.wg)(),(0,r.j4)(w,{key:0,bordered:"true",column:{xxl:1,xl:1,lg:1,md:1,sm:1,xs:1}},{default:(0,r.w5)((()=>[(0,r.Wm)(f,{label:"统计结果"},{default:(0,r.w5)((()=>[(0,r.Uk)((0,s.zw)(e.formStateWe.res),1)])),_:1})])),_:1})):(0,r.kq)("",!0),""===e.formStateWe.res&&""!==e.formStateWe.click?((0,r.wg)(),(0,r.j4)(C,{key:1,size:"small"})):(0,r.kq)("",!0)])),_:1}),(0,r.Wm)(W,{wrapperCol:{span:24},style:{"text-align":"center"}},{default:(0,r.w5)((()=>[(0,r.Wm)(h,{type:"primary",onClick:e.prevStep},{default:(0,r.w5)((()=>[n])),_:1},8,["onClick"]),(0,r.Wm)(h,{type:"primary","html-type":"submit",style:{"margin-left":"20px"},onClick:e.getres,disabled:""!==e.formStateWe.click},{default:(0,r.w5)((()=>[m])),_:1},8,["onClick","disabled"])])),_:1}),(0,r.Wm)(k),u])),_:1},8,["model","rules"])])])),_:1})}a(333);var c=a(252),f=a(4870);const w=[{title:"ID",dataIndex:"0",ellipsis:!0},{title:"签名公钥",dataIndex:"1",ellipsis:!0},{title:"权重",dataIndex:"2"},{title:"选票",dataIndex:"3",ellipsis:!0},{title:"签名",dataIndex:"4",ellipsis:!0}];var g=(0,r.aZ)({inject:["reload"],setup(){const e=(0,f.qj)({addr:"",res:"",sum:"",data:[],click:""});return{formStateWe:e,columns:w,mypagination:{defaultPageSize:3}}},created(){console.log("chancan",this.$route.params.info),this.prevStep1(this.$route.params.info)},methods:{prevStep1(e){e=JSON.parse(e),this.formStateWe.addr=e.addr,this.formStateWe.data=e.ballot},prevStep(){this.$router.push("/result")},beforeUpload1(e){return this.read1(e),!1},read1(e){const t=new FileReader;t.readAsText(e,"UTF-8"),t.onload=e=>{const t=e.target.result;var a=JSON.parse(t),r=this.formStateWe.addr.indexOf(a.addr);if(console.log("indexshism",r),-1==r)c.ZP.destroy(),c.ZP.warning("文件上传错误，不是当前投票活动参数");else{var s=new Object;s.P=a.P,s.Q=a.Q,s.G=a.G;var l=this.formStateWe.data,o=this.formStateWe.data.length,d=new Array(o),i=new Array(o),n=new Array(o),m=new Array(o);for(let e=0;e<o;e++)console.log(l[e][1]),d[e]=JSON.parse(l[e][3]),i[e]=JSON.stringify(d[e]),n[e]=JSON.parse(l[e][4]),m[e]=JSON.parse(l[e][1]);var u=count(s,d,n,m,i,o);console.log("CCCCCCCCCC",u),console.log("CCCCCCCCCC",m),this.formStateWe.share=decrypt0(s,u.C1,a.sk),this.formStateWe.C1=u.C1,this.formStateWe.C2=u.C2}}},getres(){this.formStateWe.click="click",this.$http.post("http://192.168.5.42:8888/voterwe/get_we_result",{name:sessionStorage.getItem("user"),password:sessionStorage.getItem("pass"),addr:this.formStateWe.addr}).then((e=>{if(console.log(e),"success"==e.data.result){console.log("jieguo:",e.data);var t=new Object;t.P=e.data.para[0],t.Q=e.data.para[1],t.G=e.data.para[2];var a=e.data.C2,r=e.data.Cx,s=r.length,l=100,o=decrypt1(t,a,r,s,l);console.log("b:",o),this.formStateWe.sum=o,o>0&&(this.formStateWe.res="通过"),o<0&&(this.formStateWe.res="未通过"),(o=0)&&(this.formStateWe.res="中立")}"error1"==e.data.result&&(c.ZP.destroy(),c.ZP.warning("请检查登录")),"wait"==e.data.result&&(c.ZP.destroy(),c.ZP.warning("请等候所有的参与者共同恢复结果"))}))}}}),S=a(89);const W=(0,S.Z)(g,[["render",p],["__scopeId","data-v-785b9238"]]);var C=W}}]);
//# sourceMappingURL=478.17ae86de.js.map