"use strict";(self["webpackChunkvue_web"]=self["webpackChunkvue_web"]||[]).push([[410],{5410:function(e,t,a){a.r(t),a.d(t,{default:function(){return le}});var l=a(3396),r=a(7139),o=a(9242);const n={class:"content"};function s(e,t,a,s,i,m){const u=(0,l.up)("a-popover"),d=(0,l.up)("a-step"),p=(0,l.up)("a-steps"),c=(0,l.up)("StepOne"),f=(0,l.up)("StepTwo"),h=(0,l.up)("StepThree"),S=(0,l.up)("StepFour"),w=(0,l.up)("a-card");return(0,l.wg)(),(0,l.j4)(w,{bordered:!1},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{class:"steps",current:i.currentTab},{progressDot:(0,l.w5)((({index:e,status:t,prefixCls:a})=>[(0,l.Wm)(u,null,{content:(0,l.w5)((()=>[(0,l._)("span",null,"step "+(0,r.zw)(e)+" status: "+(0,r.zw)(t),1)])),default:(0,l.w5)((()=>[(0,l._)("span",{class:(0,r.C_)(`${a}-icon-dot`)},null,2)])),_:2},1024)])),default:(0,l.w5)((()=>[(0,l.Wm)(d,{title:"投票基本信息"}),(0,l.Wm)(d,{title:"投票定制信息"}),(0,l.Wm)(d,{title:"投票项目上链"}),(0,l.Wm)(d,{title:"完成",description:"投票项目上链"})])),_:1},8,["current"]),(0,l._)("div",n,[(0,l.wy)((0,l.Wm)(c,{onNextStep:m.nextStep},null,8,["onNextStep"]),[[o.F8,0===i.currentTab]]),(0,l.wy)((0,l.Wm)(f,{onNextStep:m.nextStep,onPrevStep:m.prevStep},null,8,["onNextStep","onPrevStep"]),[[o.F8,1===i.currentTab]]),(0,l.wy)((0,l.Wm)(h,{onPrevStep:m.prevStep,onNextStep:m.nextStep},null,8,["onPrevStep","onNextStep"]),[[o.F8,2===i.currentTab]]),(0,l.wy)((0,l.Wm)(S,{onFinish:m.finish},null,8,["onFinish"]),[[o.F8,3===i.currentTab]])])])),_:1})}const i=e=>((0,l.dD)("data-v-c0026170"),e=e(),(0,l.Cn)(),e),m={style:{margin:"60px auto 0"}},u=(0,l.Uk)("下一步"),d=i((()=>(0,l._)("div",{class:"step-form-style-desc"},[(0,l._)("h3",null,"说明"),(0,l._)("h4",null,"发起匿名权重投票事项"),(0,l._)("p",null,"如果需要，这里可以放一些关于产品的常见问题说明。如果需要，这里可以放一些关于产品的常见问题说明。如果需要，这里可以放一些关于产品的常见问题说明。")],-1)));function p(e,t,a,r,o,n){const s=(0,l.up)("a-input"),i=(0,l.up)("a-form-item"),p=(0,l.up)("a-range-picker"),c=(0,l.up)("a-button"),f=(0,l.up)("a-form"),h=(0,l.up)("a-divider");return(0,l.wg)(),(0,l.iD)("div",m,[(0,l.Wm)(f,{model:e.formState,name:"custom-validation",rules:e.rules,labelCol:{lg:{span:7},sm:{span:7}},wrapperCol:{lg:{span:10},sm:{span:12}},style:{margin:"40px auto 0"},autocomplete:"off"},{default:(0,l.w5)((()=>[(0,l.Wm)(i,{"has-feedback":"",label:"决策主题",name:"title"},{default:(0,l.w5)((()=>[(0,l.Wm)(s,{size:"large",value:e.formState.title,"onUpdate:value":t[0]||(t[0]=t=>e.formState.title=t),placeholder:"输入投票主题",type:"text",autocomplete:"off"},null,8,["value"])])),_:1}),(0,l.Wm)(i,{"has-feedback":"",label:"决策内容",name:"content"},{default:(0,l.w5)((()=>[(0,l.Wm)(s,{size:"large",value:e.formState.content,"onUpdate:value":t[1]||(t[1]=t=>e.formState.content=t),placeholder:"输入投票主题",type:"text",autocomplete:"off"},null,8,["value"])])),_:1}),(0,l.Wm)(i,{"has-feedback":"",label:"选择投票时间",name:"date"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{size:"large",style:{width:"100%","border-radius":"7px",height:"48px"},value:e.formState.date,"onUpdate:value":t[2]||(t[2]=t=>e.formState.date=t),"disabled-date":e.disabledDate,"show-time":{hideDisabledOptions:!0},"value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["value","disabled-date"])])),_:1}),(0,l.Wm)(i,{wrapperCol:{span:24},style:{"text-align":"center"}},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{type:"primary","html-type":"submit",onClick:e.nextStep},{default:(0,l.w5)((()=>[u])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model","rules"]),(0,l.Wm)(h),d])}var c=a(5743),f=a.n(c),h=a(333),S=a(4870),w=(0,l.aZ)({setup(){const e=(0,S.qj)({title:"",content:"",date:void 0}),t=e=>e&&e<f()().endOf("second");let a=async(e,t)=>""===t?Promise.reject("请输入正确格式投票主题"):t.length!=t.split(" ").join("").length?Promise.reject("输入包含空格"):Promise.resolve(),l=async(e,t)=>""===t?Promise.reject("请输入正确格式投票主题"):t.length!=t.split(" ").join("").length?Promise.reject("输入包含空格"):Promise.resolve();const r={title:[{required:!0,validator:a,trigger:"change"}],content:[{required:!0,validator:l,trigger:"change"}],date:[{required:!0,message:"请选择投票日期"}]};return{dayjs:f(),formState:e,validateTitle:a,validateContent:l,rules:r,disabledDate:t}},methods:{nextStep(){var e=[];""!==this.formState.title&&this.formState.title.length==this.formState.title.split(" ").join("").length&&this.formState.date&&""!==this.formState.content&&this.formState.content.length==this.formState.content.split(" ").join("").length&&(e.push({Title:this.formState.title,Content:this.formState.content,startTime:this.formState.date[0],endTime:this.formState.date[1]}),console.log(e),h.Z.emit("Res",e),this.$emit("nextStep"))}}}),v=a(89);const g=(0,v.Z)(w,[["render",p],["__scopeId","data-v-c0026170"]]);var y=g;const _=e=>((0,l.dD)("data-v-daae6612"),e=e(),(0,l.Cn)(),e),b={style:{margin:"60px auto 0"}},k=(0,l.Uk)(" 获取加密参数 "),W={key:0},x=(0,l.Uk)(" ( "),C=(0,l.Uk)(" 请添加合法投票者. ) "),U=(0,l.Uk)("添加"),T=(0,l.Uk)("上一步"),P=(0,l.Uk)("下一步"),D=_((()=>(0,l._)("div",{class:"step-form-style-desc"},[(0,l._)("h3",null,"说明"),(0,l._)("h4",null,"发起匿名权重投票事项"),(0,l._)("p",null,"如果需要，这里可以放一些关于产品的常见问题说明。如果需要，这里可以放一些关于产品的常见问题说明。如果需要，这里可以放一些关于产品的常见问题说明。")],-1)));function Z(e,t,a,o,n,s){const i=(0,l.up)("PlusOutlined"),m=(0,l.up)("a-button"),u=(0,l.up)("a-form-item"),d=(0,l.up)("a-descriptions-item"),p=(0,l.up)("a-descriptions"),c=(0,l.up)("UserOutlined"),f=(0,l.up)("a-avatar"),h=(0,l.up)("SmileOutlined"),S=(0,l.up)("a-typography-text"),w=(0,l.up)("a-input"),v=(0,l.up)("a-input-number"),g=(0,l.up)("a-form"),y=(0,l.up)("a-modal"),_=(0,l.up)("a-divider");return(0,l.wg)(),(0,l.iD)("div",b,[(0,l.Wm)(g,{model:e.formState,name:"custom-validation",rules:e.rules,labelCol:{lg:{span:7},sm:{span:7}},wrapperCol:{lg:{span:10},sm:{span:20}},style:{margin:"40px auto 0"},autocomplete:"off"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{label:"加密参数",rules:[{required:!0}]},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{size:"large",type:"dashed",style:{width:"80%"},onClick:e.getpara},{default:(0,l.w5)((()=>[(0,l.Wm)(i),k])),_:1},8,["onClick"])])),_:1}),e.formState.encryption.length?((0,l.wg)(),(0,l.j4)(u,{key:0,label:"加密参数"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{bordered:"",column:{xxl:1,xl:1,lg:1,md:1,sm:1,xs:1}},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{label:"P"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,r.zw)(e.formState.encryption[0]),1)])),_:1}),(0,l.Wm)(d,{label:"G"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,r.zw)(e.formState.encryption[1]),1)])),_:1}),(0,l.Wm)(d,{label:"G"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,r.zw)(e.formState.encryption[2]),1)])),_:1})])),_:1})])),_:1})):(0,l.kq)("",!0),(0,l.Wm)(u,{label:"添加投票者",rules:[{required:!0}]},{default:(0,l.w5)((()=>[e.formState.users.length?((0,l.wg)(),(0,l.iD)("ul",W,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.formState.users,(e=>((0,l.wg)(),(0,l.iD)("li",{key:e.key,class:"user"},[(0,l.Wm)(f,null,{icon:(0,l.w5)((()=>[(0,l.Wm)(c)])),_:1}),(0,l.Uk)(" "+(0,r.zw)(e.id)+" - "+(0,r.zw)(e.weight),1)])))),128))])):((0,l.wg)(),(0,l.j4)(S,{key:1,class:"ant-form-text",type:"secondary"},{default:(0,l.w5)((()=>[x,(0,l.Wm)(h),C])),_:1})),(0,l.Wm)(m,{"html-type":"button",style:{margin:"0 8px"},onClick:t[0]||(t[0]=t=>e.visible=!0)},{default:(0,l.w5)((()=>[U])),_:1})])),_:1}),(0,l.Wm)(y,{visible:e.visible,"onUpdate:visible":t[3]||(t[3]=t=>e.visible=t),title:"投票者信息",onOk:e.onOk},{default:(0,l.w5)((()=>[(0,l.Wm)(g,{ref:"modalFormRef",model:e.modalFormState,layout:"vertical",name:"userForm"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{name:"id",label:"投票者ID",rules:[{required:!0}]},{default:(0,l.w5)((()=>[(0,l.Wm)(w,{value:e.modalFormState.id,"onUpdate:value":t[1]||(t[1]=t=>e.modalFormState.id=t)},null,8,["value"])])),_:1}),(0,l.Wm)(u,{name:"weight",label:"投票者权重",rules:[{required:!0}]},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{value:e.modalFormState.weight,"onUpdate:value":t[2]||(t[2]=t=>e.modalFormState.weight=t),min:1,max:10},null,8,["value"])])),_:1})])),_:1},8,["model"])])),_:1},8,["visible","onOk"]),(0,l.Wm)(u,{wrapperCol:{span:24},style:{"text-align":"center"}},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{type:"primary",onClick:e.prevStep},{default:(0,l.w5)((()=>[T])),_:1},8,["onClick"]),(0,l.Wm)(m,{type:"primary","html-type":"submit",style:{"margin-left":"8px"},onClick:e.nextStep},{default:(0,l.w5)((()=>[P])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model","rules"]),(0,l.Wm)(_),D])}var z=a(252),j=(0,l.aZ)({setup(){const e=(0,S.qj)({encryption:[],users:[]}),t=(0,S.iH)(),a=(0,S.iH)(),r=(0,S.iH)(!1),o=(0,S.iH)({});(0,l.YP)(r,(()=>{o.value={}}),{flush:"post"});const n=()=>{a.value.validateFields().then((()=>{e.users.push({...o.value,key:Date.now()}),r.value=!1}))},s=()=>{console.log("Finish:",(0,S.IU)(e))};let i=async(e,t)=>""===t?Promise.reject("请输入正确格式投票主题"):t.length!=t.split(" ").join("").length?Promise.reject("输入包含空格"):Promise.resolve();const m={encryption:[{required:!0,validator:i,trigger:"change"}]};return{formState:e,rules:m,validateEncryption:i,formRef:t,modalFormRef:a,visible:r,modalFormState:o,onOk:n,onFinish:s}},methods:{getpara(){var e=setup(256);console.log(e.P),console.log(typeof e),this.formState.encryption=Object.values(e)},prevStep(){this.$emit("prevStep")},nextStep(){""!=this.formState.encryption&&""!=this.formState.users?(h.Z.emit("Res1",this.formState.encryption),h.Z.emit("Res2",this.formState.users),this.$emit("nextStep")):(z.ZP.destroy(),z.ZP.warning("请生成定制信息"))}}});const F=(0,v.Z)(j,[["render",Z],["__scopeId","data-v-daae6612"]]);var I=F;const q=e=>((0,l.dD)("data-v-3a9fbb36"),e=e(),(0,l.Cn)(),e),O={style:{margin:"60px auto 0"}},R=q((()=>(0,l._)("h5",{style:{"text-align":"center","margin-top":"20px"}},"确认投票发起信息",-1))),G=(0,l.Uk)("上一步"),H=(0,l.Uk)("下一步"),$=q((()=>(0,l._)("div",{class:"step-form-style-desc"},[(0,l._)("h3",null,"说明"),(0,l._)("h4",null,"发起匿名权重投票事项"),(0,l._)("p",null,"如果需要，这里可以放一些关于产品的常见问题说明。如果需要，这里可以放一些关于产品的常见问题说明。如果需要，这里可以放一些关于产品的常见问题说明。")],-1)));function Y(e,t,a,o,n,s){const i=(0,l.up)("a-descriptions-item"),m=(0,l.up)("a-descriptions"),u=(0,l.up)("a-form-item"),d=(0,l.up)("a-button"),p=(0,l.up)("a-form"),c=(0,l.up)("a-divider");return(0,l.wg)(),(0,l.iD)("div",O,[R,(0,l.Wm)(p,{model:e.formState,name:"custom-validation",rules:e.rules,labelCol:{lg:{span:7},sm:{span:7}},wrapperCol:{lg:{span:10},sm:{span:20}},style:{margin:"40px auto 0"},autocomplete:"off"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{label:" "},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{bordered:"true",column:{xxl:1,xl:1,lg:1,md:1,sm:1,xs:1}},{default:(0,l.w5)((()=>[(0,l.Wm)(i,{label:"决策主题"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,r.zw)(e.formState.title),1)])),_:1}),(0,l.Wm)(i,{label:"决策内容"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,r.zw)(e.formState.content),1)])),_:1}),(0,l.Wm)(i,{label:"投票时间"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,r.zw)(e.formState.startTime)+" - - "+(0,r.zw)(e.formState.endTime),1)])),_:1}),(0,l.Wm)(i,{label:"P"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,r.zw)(e.formState.P),1)])),_:1}),(0,l.Wm)(i,{label:"G"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,r.zw)(e.formState.Q),1)])),_:1}),(0,l.Wm)(i,{label:"G"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,r.zw)(e.formState.G),1)])),_:1}),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.formState.voters,(e=>((0,l.wg)(),(0,l.j4)(i,{label:"投票者",key:e.id},{default:(0,l.w5)((()=>[(0,l.Uk)((0,r.zw)(e.id)+"--"+(0,r.zw)(e.weight),1)])),_:2},1024)))),128))])),_:1})])),_:1}),(0,l.Wm)(u,{wrapperCol:{span:24},style:{"text-align":"center"}},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{type:"primary",onClick:e.prevStep},{default:(0,l.w5)((()=>[G])),_:1},8,["onClick"]),(0,l.Wm)(d,{type:"primary","html-type":"submit",style:{"margin-left":"8px"},onClick:e.nextStep,loading:""!==e.formState.click},{default:(0,l.w5)((()=>[H])),_:1},8,["onClick","loading"])])),_:1})])),_:1},8,["model","rules"]),(0,l.Wm)(c),$])}var N=(0,l.aZ)({setup(){const e=(0,S.qj)({title:"",startTime:"",endTime:"",content:"",P:"",Q:"",G:"",voters:[],click:""});return{formState:e}},created(){h.Z.on("Res",(e=>{this.formState.title=e[0].Title,this.formState.startTime=e[0].startTime,this.formState.endTime=e[0].endTime,this.formState.content=e[0].Content})),h.Z.on("Res1",(e=>{this.formState.P=e[0],this.formState.Q=e[1],this.formState.G=e[2]})),h.Z.on("Res2",(e=>{console.log(e),this.formState.voters=e}))},methods:{prevStep(){this.$emit("prevStep")},nextStep(){this.formState.click="click",this.send(),console.log("2")},send(){console.log(this.formState.title),this.$http.post("http://192.168.5.42:8888/manager/createWe",{name:sessionStorage.getItem("user"),password:sessionStorage.getItem("pass"),title:this.formState.title,startTime:this.formState.startTime,endTime:this.formState.endTime,content:this.formState.content,P:this.formState.P,Q:this.formState.Q,G:this.formState.G,voters:this.formState.voters}).then((e=>{if(this.formState.click="",console.log(e),"success"==e.data.result){var t=[];t=e.data,h.Z.emit("ResID",t),this.$emit("nextStep")}"error1"==e.data.result&&(z.ZP.destroy(),z.ZP.warning("请检查登录")),"error2"==e.data.result&&(z.ZP.destroy(),z.ZP.warning("投票合约部署失败")),"error3"==e.data.result&&(z.ZP.destroy(),z.ZP.warning("上链失败"))}))}}});const Q=(0,v.Z)(N,[["render",Y],["__scopeId","data-v-3a9fbb36"]]);var K=Q;const M={style:{margin:"40px auto 0"}},E=(0,l.Uk)(" 请注意保存返回的该投票项目ID:"),A=(0,l.Uk)(" 该投票项目的合约地址:"),B=(0,l.Uk)("再次发起"),J=(0,l.Uk)("投票");function L(e,t,a,o,n,s){const i=(0,l.up)("a-typography-title"),m=(0,l.up)("a-button"),u=(0,l.up)("a-result");return(0,l.wg)(),(0,l.iD)("div",M,[(0,l.Wm)(u,{status:"success",title:"成功发起投票项目",model:e.formState},{subTitle:(0,l.w5)((()=>[E,(0,l.Wm)(i,{level:2},{default:(0,l.w5)((()=>[(0,l.Uk)((0,r.zw)(e.ID),1)])),_:1}),A,(0,l.Wm)(i,{level:4},{default:(0,l.w5)((()=>[(0,l.Uk)((0,r.zw)(e.addr),1)])),_:1})])),extra:(0,l.w5)((()=>[(0,l.Wm)(m,{key:"console",type:"primary",onClick:e.finish},{default:(0,l.w5)((()=>[B])),_:1},8,["onClick"]),(0,l.Wm)(m,{key:"buy",onClick:e.voting},{default:(0,l.w5)((()=>[J])),_:1},8,["onClick"])])),_:1},8,["model"])])}var V=(0,l.aZ)({inject:["reload"],data(){return{ID:"",addr:""}},created(){h.Z.on("ResID",(e=>{console.log("sdsd",e),console.log(typeof e),this.ID=e.ID,this.addr=e.addr}))},methods:{finish(){this.reload()},voting(){this.$router.push("/addvoting")}}});const X=(0,v.Z)(V,[["render",L]]);var ee=X,te={name:"StepForm",components:{StepOne:y,StepTwo:I,StepThree:K,StepFour:ee},data(){return{currentTab:0}},methods:{nextStep(){this.currentTab<3&&(this.currentTab+=1)},prevStep(){this.currentTab>0&&(this.currentTab-=1)},finish(){this.currentTab=0}}};const ae=(0,v.Z)(te,[["render",s],["__scopeId","data-v-2068ee7d"]]);var le=ae}}]);
//# sourceMappingURL=410.3bdabe5f.js.map