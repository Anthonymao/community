"use strict";(self["webpackChunkvue_web"]=self["webpackChunkvue_web"]||[]).push([[399],{2399:function(e,t,a){a.r(t),a.d(t,{default:function(){return k}});var r=a(3396),s=a(7139);const l=e=>((0,r.dD)("data-v-3734f3d4"),e=e(),(0,r.Cn)(),e),o={style:{margin:"3px auto 0"}},d=l((()=>(0,r._)("h5",{style:{"text-align":"center",margin:"20px"}},"权重投票活动链上选票信息汇总",-1))),n=(0,r.Uk)("选票信息"),i=(0,r.Uk)("上一步"),u=(0,r.Uk)("获取结果"),p=l((()=>(0,r._)("div",{class:"step-form-style-desc"},[(0,r._)("h3",null,"说明"),(0,r._)("h4",null,"加入匿名权重投票事项：请根据以上项目ID返回投票信息完成投票表决。")],-1)));function m(e,t,a,l,m,c){const f=(0,r.up)("a-descriptions-item"),g=(0,r.up)("a-descriptions"),w=(0,r.up)("a-tooltip"),h=(0,r.up)("a-table"),S=(0,r.up)("a-form-item"),k=(0,r.up)("a-spin"),v=(0,r.up)("a-button"),y=(0,r.up)("a-divider"),b=(0,r.up)("a-form"),x=(0,r.up)("a-card");return(0,r.wg)(),(0,r.j4)(x,{bordered:!1},{default:(0,r.w5)((()=>[(0,r._)("div",o,[(0,r.Wm)(b,{model:e.formState,name:"custom-validation",rules:e.rules,labelCol:{lg:{span:7},sm:{span:7}},wrapperCol:{lg:{span:10},sm:{span:12}},style:{margin:"40px auto 0"},autocomplete:"off"},{default:(0,r.w5)((()=>[d,(0,r.Wm)(S,{label:"投票信息",rules:[{required:!0}]},{default:(0,r.w5)((()=>[(0,r.Wm)(g,{bordered:"true",column:{xxl:1,xl:1,lg:1,md:1,sm:1,xs:1}},{default:(0,r.w5)((()=>[(0,r.Wm)(f,{label:"投票地址"},{default:(0,r.w5)((()=>[(0,r.Uk)((0,s.zw)(e.formState.addr),1)])),_:1})])),_:1}),""!=e.formState.data?((0,r.wg)(),(0,r.j4)(h,{key:0,columns:e.columns,"data-source":e.formState.data,pagination:e.mypagination,size:"large",bordered:""},{bodyCell:(0,r.w5)((({column:e,text:t})=>["name"===e.dataIndex?((0,r.wg)(),(0,r.j4)(w,{key:0},{title:(0,r.w5)((()=>[(0,r.Uk)((0,s.zw)(t),1)])),default:(0,r.w5)((()=>[(0,r.Uk)(" "+(0,s.zw)(t),1)])),_:2},1024)):(0,r.kq)("",!0)])),title:(0,r.w5)((()=>[n])),_:1},8,["columns","data-source","pagination"])):(0,r.kq)("",!0)])),_:1}),(0,r.Wm)(S,{label:"统计结果",rules:[{required:!0}]},{default:(0,r.w5)((()=>[e.formState.result?((0,r.wg)(!0),(0,r.iD)(r.HY,{key:0},(0,r.Ko)(e.formState.result,(e=>((0,r.wg)(),(0,r.j4)(g,{bordered:"true",column:{xxl:1,xl:1,lg:1,md:1,sm:1,xs:1},key:Date.now()},{default:(0,r.w5)((()=>[(0,r.Wm)(f,{label:e[0]},{default:(0,r.w5)((()=>[(0,r.Uk)((0,s.zw)(e[1]),1)])),_:2},1032,["label"])])),_:2},1024)))),128)):(0,r.kq)("",!0),""===e.formState.result&&""!==e.formState.click?((0,r.wg)(),(0,r.j4)(k,{key:1,size:"small"})):(0,r.kq)("",!0)])),_:1}),(0,r.Wm)(S,{wrapperCol:{span:24},style:{"text-align":"center"}},{default:(0,r.w5)((()=>[(0,r.Wm)(v,{type:"primary",onClick:e.prevStep},{default:(0,r.w5)((()=>[i])),_:1},8,["onClick"]),(0,r.Wm)(v,{type:"primary","html-type":"submit",style:{"margin-left":"20px"},onClick:e.getres,disabled:""!==e.formState.click},{default:(0,r.w5)((()=>[u])),_:1},8,["onClick","disabled"])])),_:1}),(0,r.Wm)(y),p])),_:1},8,["model","rules"])])])),_:1})}a(333);var c=a(252),f=a(4870);const g=[{title:"ID",dataIndex:"0",ellipsis:!0},{title:"加密选票",dataIndex:"1",ellipsis:!0},{title:"选票签名",dataIndex:"2",ellipsis:!0}];var w=(0,r.aZ)({inject:["reload"],setup(){const e=(0,f.qj)({addr:"",res:"",sum:"",data:[],click:"",result:""});return{formState:e,columns:g,mypagination:{defaultPageSize:3}}},created(){console.log("chancan",this.$route.params.info),this.prevStep1(this.$route.params.info)},methods:{prevStep1(e){e=JSON.parse(e),this.formState.addr=e.addr,this.formState.data=e.ballot},prevStep(){this.$router.push("/result")},hex2str(e){var t,a=e.trim(),r="0x"===a.substr(0,2).toLowerCase()?a.substr(2):a,s=r.length;if(s%2!==0)return alert("Illegal Format ASCII Code!"),"";for(var l=[],o=0;o<s;o+=2)t=parseInt(r.substr(o,2),16),l.push(String.fromCharCode(t));return l.join("")},getres(){this.formState.click="click",this.$http.post("http://192.168.5.42:8888/voteravc/get_avc_result",{name:sessionStorage.getItem("user"),password:sessionStorage.getItem("pass"),addr:this.formState.addr}).then((e=>{if(console.log(e),"success"==e.data.result){console.log("jieguo:",e.data);var t=new Object;t.P=e.data.para[0],t.Q=e.data.para[1],t.G=e.data.para[2];var a=this.formState.data,r=e.data.para[4];console.log("K",r);var s=e.data.PK,l=this.formState.data.length,o=new Array(l),d=e.data.allshare;for(let e=0;e<l;e++)o[e]=JSON.parse(a[e][1]);var n=new Array;console.log("dsdsdsdsdsds",JSON.parse(d[0]));for(let e=0;e<l;e++){var i=new Array,u=new Array;for(let t=0;t<r;t++){console.log("dsds",d);var p=JSON.parse(d[t]);i.push(p.x[e]),u.push(p.y[e])}o[e].x=i,o[e].y=u,console.log("PK:",s[0]),n[e]=decrypt11(t,o[e],s[0],r)}for(let e=0;e<l;e++)n[e]=this.hex2str(n[e]),console.log(n[e]);var m={};n.forEach((function(e){m[e]=m[e]?m[e]+1:1})),console.log(m),this.formState.result=Object.entries(m),console.log(Object.entries(this.formState.result))}"error1"==e.data.result&&(c.ZP.destroy(),c.ZP.warning("请检查登录")),"wait"==e.data.result&&(c.ZP.destroy(),c.ZP.warning("请等候所有的参与者共同恢复结果"))}))}}}),h=a(89);const S=(0,h.Z)(w,[["render",m],["__scopeId","data-v-3734f3d4"]]);var k=S}}]);
//# sourceMappingURL=399.cf037d15.js.map